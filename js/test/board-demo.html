<html>
<head>
  <title>Test GrandLoop Cycling Canvas</title>
  <link rel="stylesheet" type="text/css" media="all" href="test.css"/>
  <script src="../../jquery/jquery-1.9.1.js"></script>
  <script src="../base.js"></script>
  <script src="../debug.js"></script>
  <script src="../board.js"></script>
  <script src="../boardnode.js"></script>
  <script src="../chessboard.js"></script>
  <script src="../canvas.js"></script>
  <script src="../event.js"></script>
  <script src="../eventManager.js"></script>
  <script src="../grandloop.js"></script>
  <script src="../input.js"></script>
  <script src="../point.js"></script>
  <script src="../requestAnimationFrame.js"></script>
  <script>
    $(document).ready(function() {
      var canvas = window.dirg.Canvas({ 'dom': $('#field')[0] });
      var grandloop = dirg.grandloop.create();
      var eventManager = dirg.eventManager.create();
      var input = dirg.input.create({
          'eventManager': eventManager,
          'inputElement': '#field' });

      var board = dirg.ChessBoard();

      // Expose for debugging.
      window.game = {
        'canvas': canvas,
        'eventManager': eventManager,
        'grandloop': grandloop,
        'input': input
      };

      // Called every cycle to process queued events and update UI.
      grandloop.pushHook('PRE',
        function() {
          eventManager.process();
          // Update the Mouse Position HTML
          $("#mouse").text("(" + input.cursor.x + ", " +input.cursor.y +")");

          canvas.clear();
          board.render(canvas);
        });

      grandloop.start();
    });
  </script>
</head>
<body>
  <h1>Board Demo</h1>
  <center>
    <p>Cursor: <span id="mouse">Not initialized</span></p>
    <canvas id="field" width="800" height="800">
    </canvas>
  </center>
  <p>Not a unit test.</p>
  <p>Test that Input posts Events to Event Manager.</p>
  <p>See console log for output.</p>
</body>
</html>
